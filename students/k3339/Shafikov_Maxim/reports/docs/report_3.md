# –û—Ç—á–µ—Ç –ø–æ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ ‚Ññ3

**–í—ã–ø–æ–ª–Ω–∏–ª:** –®–∞—Ñ–∏–∫–æ–≤ –ú–∞–∫—Å–∏–º –ê–∑–∞—Ç–æ–≤–∏—á

**–§–∞–∫—É–ª—å—Ç–µ—Ç:** –ü–ò–ù (–ò–ö–¢)

**–ì—Ä—É–ø–ø–∞:** –ö3339

**–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:** –ì–æ–≤–æ—Ä–æ–≤ –ê–Ω—Ç–æ–Ω –ò–≥–æ—Ä–µ–≤–∏—á

---

–û—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ [—Å—Å—ã–ª–∫–µ](https://github.com/aimclub/Edulytica/)

---


## üîπ 1. –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–¶–µ–ª—å—é –¥–∞–Ω–Ω–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è "Edulytica" —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–±–æ—Ä –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —á–∞—Å—Ç–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –º–æ–¥–µ–ª—è–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## üîπ 2. –ó–∞–¥–∞–Ω–∏–µ

1.  –°–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
2.  –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º JWT.
3.  –°–æ–∑–¥–∞—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π API-—Å–µ—Ä–≤–∏—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π: —Å–æ–∑–¥–∞–Ω–∏–µ "—Ç–∏–∫–µ—Ç–æ–≤" –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º–∏ (events), –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
4.  –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Å–µ—Ä–≤–∏—Å-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã–º–∏, –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ (–ø–∞–π–ø–ª–∞–π–Ω–∞–º–∏), –∫–æ—Ç–æ—Ä—ã–µ –≤–∫–ª—é—á–∞—é—Ç –≤ —Å–µ–±—è –≤—ã–∑–æ–≤—ã —Ä–∞–∑–ª–∏—á–Ω—ã—Ö LLM-–º–æ–¥–µ–ª–µ–π.
5.  –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã-–≤–æ—Ä–∫–µ—Ä—ã –¥–ª—è –º–æ–¥–µ–ª–µ–π –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—É—á–∞—é—Ç –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π Kafka.
6.  –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å RAG (Retrieval-Augmented Generation) –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –º–æ–¥–µ–ª—è–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∏–∑ –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π.
7.  –ù–∞—Å—Ç—Ä–æ–∏—Ç—å API Gateway (Nginx) –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º.
8.  –û–±–µ—Å–ø–µ—á–∏—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ —Å –ø–æ–º–æ—â—å—é –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –±—Ä–æ–∫–µ—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏–π Kafka.

## üîπ 3. –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

*   **–Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è:** Python 3.11+
*   **–§—Ä–µ–π–º–≤–æ—Ä–∫:** FastAPI
*   **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** PostgreSQL
*   **ORM –∏ –º–∏–≥—Ä–∞—Ü–∏–∏:** SQLAlchemy, Alembic
*   **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:** Pydantic
*   **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** JWT (JSON Web Tokens)
*   **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –∏ –æ—á–µ—Ä–µ–¥–∏:** Kafka
*   **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º:** Redis
*   **–í–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–¥–ª—è RAG):** ChromaDB
*   **API Gateway:** Nginx
*   **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è:** Docker, Docker Compose

## üîπ 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `src/`:

*   `auth/`: –°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏. –û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é, –≤—Ö–æ–¥, –≤—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏.
*   `edulytica_api/`: –û—Å–Ω–æ–≤–Ω–æ–π API-—Å–µ—Ä–≤–∏—Å. –Ø–≤–ª—è–µ—Ç—Å—è –≥–ª–∞–≤–Ω–æ–π —Ç–æ—á–∫–æ–π –≤—Ö–æ–¥–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–æ–≤, –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤, –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤), –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏.
*   `orchestration/`: –°–µ—Ä–≤–∏—Å-–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä. –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Å–ª–æ–∂–Ω—ã—Ö –ø–∞–π–ø–ª–∞–π–Ω–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –û–Ω —Ä–∞–∑–±–∏–≤–∞–µ—Ç –∑–∞–¥–∞—á—É –Ω–∞ –ø–æ–¥–∑–∞–¥–∞—á–∏, —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç—ã –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –≤ Kafka.
*   `models/`: –°–µ—Ä–≤–∏—Å—ã-–≤–æ—Ä–∫–µ—Ä—ã –¥–ª—è LLM. –ö–∞–∂–¥—ã–π —Ç–∞–∫–æ–π —Å–µ—Ä–≤–∏—Å "—Å–ª—É—à–∞–µ—Ç" —Å–≤–æ—é —Ç–µ–º—É –≤ Kafka, –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á—É, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –µ–µ —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Qwen –∏–ª–∏ Vikhr) –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –æ–±—â—É—é —Ç–µ–º—É –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.
*   `rag/`: –°–µ—Ä–≤–∏—Å Retrieval-Augmented Generation. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º. –û–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö ChromaDB, –∫—É–¥–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è —Ç–µ–∫—Å—Ç—ã.
*   `gateway/`: –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx, –∫–æ—Ç–æ—Ä—ã–π –≤—ã—Å—Ç—É–ø–∞–µ—Ç –≤ —Ä–æ–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ HTTP-–∑–∞–ø—Ä–æ—Å—ã –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –∏—Ö –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã (`auth`, `edulytica_api`).
*   `common/`: –û–±—â–∏–π –∫–æ–¥, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö. –í–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –º–æ–¥–µ–ª–∏ SQLAlchemy, CRUD-–æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î, —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ —Ç.–¥.
*   `llm/`: –ê–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —è–∑—ã–∫–æ–≤—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏.

## üîπ 5. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

*   **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é email –∏ –ø–∞—Ä–æ–ª—è. –ù–∞ –ø–æ—á—Ç—É –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–æ–¥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.
*   **–õ–æ–≥–∏–Ω:** –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –ª–æ–≥–∏–Ω–∞ –∏ –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç `access_token` –∏ `refresh_token`. `refresh_token` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ `HttpOnly` cookie –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
*   **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:** `access_token` –∏–º–µ–µ—Ç –∫–æ—Ä–æ—Ç–∫–∏–π —Å—Ä–æ–∫ –∂–∏–∑–Ω–∏. –ö–æ–≥–¥–∞ –æ–Ω –∏—Å—Ç–µ–∫–∞–µ—Ç, —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –º–æ–∂–µ—Ç –∑–∞–ø—Ä–æ—Å–∏—Ç—å –Ω–æ–≤—ã–π, –∏—Å–ø–æ–ª—å–∑—É—è `refresh_token`.
*   **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–º:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ (–∏–º—è, –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é) –∏ –ø–∞—Ä–æ–ª—å.

–ü—Ä–∏–º–µ—Ä —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É –∏–∑ `src/auth/routers/auth.py`:
```python
@api_logs(auth_router.post('/login'))
async def login_handler(
        response: Response,
        login: str = Body(...),
        password: str = Body(...),
        session: AsyncSession = Depends(get_session)
):
    # ... –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–∞—Ä–æ–ª—è ...
    user = await UserCrud.get_active_user(session=session, login=login)
    if not user or not verify_password(password, user.password_hash):
        raise HTTPException(
            status_code=HTTP_401_UNAUTHORIZED,
            detail='Credentials are incorrect'
        )

    # ... —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ ...
    access_token = create_access_token(user.id)
    checker = uuid.uuid4()
    refresh_token = create_refresh_token(subject=user.id, checker=checker)

    # ... —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ refresh_token –≤ –ë–î –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ cookie ...
    response.set_cookie(
        key="refresh_token",
        value=f"Bearer {refresh_token}",
        httponly=True,
        expires=get_expiry(REFRESH_TOKEN_EXPIRE_MINUTES)
    )
    return {'detail': 'Credentials are correct', 'access_token': access_token}
```

–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –∑–∞–ø—É—Å–∫ –ø–∞–π–ø–ª–∞–π–Ω–æ–≤
–≠—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —á–µ—Ä–µ–∑ edulytica_api –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç (.pdf, .docx) –∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∏–ø –∑–∞–¥–∞—á–∏ (mega_task_id).
2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞: –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–µ—Ç—Å—è "—Ç–∏–∫–µ—Ç", —Å–≤—è–∑—ã–≤–∞—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –¥–æ–∫—É–º–µ–Ω—Ç –∏ –∑–∞–¥–∞—á—É.
3. –ó–∞–ø—É—Å–∫ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏: edulytica_api –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –≤ —Å–µ—Ä–≤–∏—Å orchestration, –ø–µ—Ä–µ–¥–∞–≤–∞—è ID —Ç–∏–∫–µ—Ç–∞, —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞ –∏ ID –∑–∞–¥–∞—á–∏. –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ, —á—Ç–æ–±—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
4. –†–∞–±–æ—Ç–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
   - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ mega_task_id –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –ø–æ–¥–∑–∞–¥–∞—á.
   - –û–Ω –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–∏–∫–µ—Ç–∞ –≤ Redis.
   - –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á, —É –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
   - –î–ª—è –∫–∞–∂–¥–æ–π –ø–æ–¥–∑–∞–¥–∞—á–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –ø—Ä–æ–º–ø—Ç. –ï—Å–ª–∏ –ø–æ–¥–∑–∞–¥–∞—á–∞ —Ç—Ä–µ–±—É–µ—Ç RAG, –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ rag-—Å–µ—Ä–≤–∏—Å—É –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞.
   - –ó–∞–¥–∞—á–∞ —Å –ø—Ä–æ–º–ø—Ç–æ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –Ω—É–∂–Ω—É—é —Ç–µ–º—É Kafka (–Ω–∞–ø—Ä–∏–º–µ—Ä, llm_tasks.qwen).
5. –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–æ–¥–µ–ª—å—é:
   - –°–µ—Ä–≤–∏—Å-–≤–æ—Ä–∫–µ—Ä (models) –ø–æ–ª—É—á–∞–µ—Ç –∑–∞–¥–∞—á—É –∏–∑ Kafka.
   - –û–Ω –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏ –∏ –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
   - –†–µ–∑—É–ª—å—Ç–∞—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ–±—â—É—é —Ç–µ–º—É llm_tasks.result.
6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è:
   - –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–ª—É—à–∞–µ—Ç —Ç–µ–º—É llm_tasks.result. –ü–æ–ª—É—á–∏–≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –æ–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –≤ Redis (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞ COMPLETED) –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
   - –ó–∞—Ç–µ–º –æ–Ω –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ç–æ—Ä—ã—Ö —Ç–µ–ø–µ—Ä—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.
7. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ: –ö–æ–≥–¥–∞ –≤—Å–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–±–∏—Ä–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –∏ —á–µ—Ä–µ–∑ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π API-–≤—ã–∑–æ–≤ –∫ edulytica_api —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –µ–≥–æ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö, –ø–æ–º–µ—á–∞—è —Ç–∏–∫–µ—Ç –∫–∞–∫ "–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π".

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞ –≤ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–µ –∏–∑ src/orchestration/orchestrator.py:
```python
class Orchestrator:
    # ...
    async def run_pipeline(
            self, ticket_id: Union[str, uuid.UUID], document_text: str
    ):
        dependencies = self.TASKS.get(self.mega_task_id)
        # ...
        await self.state_manager.create_ticket(
            ticket_id=ticket_id,
            # ...
        )

        initial_subtasks_to_run = []
        for task_id, subtasks in dependencies.items():
            for subtask_id, details in subtasks.items():
                if not details.get("dependencies"):
                    initial_subtasks_to_run.append(subtask_id)

        execution_tasks = [
            self._execute_subtask(ticket_id, subtask_id, document_text)
            for subtask_id in initial_subtasks_to_run
        ]

        if execution_tasks:
            await asyncio.gather(*execution_tasks)
```

## üîπ 6. –í—ã–≤–æ–¥
–í —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª–∞ —É—Å–ø–µ—à–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º FastAPI. –ë—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã –∫–ª—é—á–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã, –æ—Ç–≤–µ—á–∞—é—â–∏–µ –∑–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, –æ–±—Ä–∞–±–æ—Ç–∫—É –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—é —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å LLM-–º–æ–¥–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ –±—Ä–æ–∫–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π Kafka. –í—Å–µ –±—ã–ª–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ —Å –ø–æ–º–æ—â—å—é docker-compose –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è.
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –ø–æ–∑–≤–æ–ª–∏–ª–æ —Å–æ–∑–¥–∞—Ç—å –≥–∏–±–∫—É—é –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—É—é —Å–∏—Å—Ç–µ–º—É, —Å–ø–æ—Å–æ–±–Ω—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ä–µ—Å—É—Ä—Å–æ–µ–º–∫–∏–µ –∑–∞–¥–∞—á–∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –ø—Ä–æ—á–Ω—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.
